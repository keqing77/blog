---
id: typescript-interview
slug: /typescript-interview
title: TypeScripté¢è¯•é¢˜
date: 2022-11-15
authors: keqing
tags: [typescript]
keywords: [typescript]
sidebar_position: 4
---

## `type A = {name:string}` ä»£è¡¨ä»€ä¹ˆ?

åªæ˜¯é™åˆ¶äº†è¿™ä¸ªå¯¹è±¡ **å±æ€§** `name` çš„ **ç±»å‹**ä¸º `string`, è€Œä¸æ˜¯ **è¿™ä¸ªå¯¹è±¡åªæœ‰ä¸€ä¸ªå±æ€§name ç±»å‹ä¸º string**

## æ€ä¹ˆç†è§£æ³›å‹?

> å¯ä»¥ç†è§£ä¸º`ç±»å‹çš„å˜é‡`, ä½ ä¸€å®šä½¿ç”¨è¿‡`å‡½æ•°å‚æ•°`, å¯ä»¥é€šè¿‡æå‰å®šä¹‰å‚æ•°, ç„¶åä½¿ç”¨çš„æ—¶å€™æ‰ç»™å‡½æ•° `ä¼ å€¼`
> 
> `æ³›å‹`ä¹Ÿæ˜¯ç±»ä¼¼çš„, ä½ å¯ä»¥ç”¨ä»»æ„å­—ç¬¦æ¥å ä½è¡¨ç¤ºç±»å‹,åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰ä¼ å…¥ `ç±»å‹`  

```ts {1,6-8}
const add = (a:number,b:number) => a + b;

add(1,2) 
// ä½¿ç”¨ add()å‡½æ•°æ‰ç»™å‡½æ•°å‚æ•°ä¼ å…¥å…·ä½“çš„å€¼ 1, 2

function identity<T>(arg: T): T {
    return arg;
}

const output = identity<string>("myString");  // type of output will be 'string'
```
ä½¿ç”¨ T æ¥å ä½,è€Œä½¿ç”¨çš„æ—¶å€™å®šä¹‰å…·ä½“ç±»å‹, æ³›å‹ä½¿å¾—`å¢å¼ºä»£ç å¤ç”¨æ€§`çš„åŒæ—¶å¹¶ä¸”ä¿è¯`ç±»å‹å®‰å…¨` 

æ³›å‹è¡¨ç¤ºå®½æ³›çš„ç±»å‹, æ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™é€šå¸¸æ­é… `keyof` ç­‰ç­‰å…¶ä»–ç±»å‹çº¦æŸå…³é”®å­—çº¦æŸç±»å‹åä½¿ç”¨æ¥ä¿è¯ç±»å‹å®‰å…¨


## ? å’Œ ?? ä»£è¡¨ä»€ä¹ˆ?

- `?` è¡¨ç¤ºè¯¥å±æ€§æ˜¯å¯é€‰çš„, æ¯”å¦‚å‡½æ•°å‚æ•°å¯ä¼ å¯ä¸ä¼  (å¯ä»¥å¤šä¼ , ä½†ä¸å¯ä»¥å°‘ä¼ )

- `??Â `æ˜¯ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ã€‚å®ƒç”¨äºåœ¨å·¦ä¾§è¡¨è¾¾å¼çš„å€¼ä¸ºÂ nullÂ æˆ–Â undefinedÂ æ—¶è¿”å›å³ä¾§è¡¨è¾¾å¼çš„å€¼ï¼Œå¦åˆ™è¿”å›å·¦ä¾§è¡¨è¾¾å¼çš„å€¼

```ts {1,8}
//  ?
type Dinner = {
  chicken? : string,
  fish?: string,
  rice: string
} // ä¸€é¡¿æ™šé¤ä¸€å®šæœ‰ç±³é¥­, é±¼å’Œé¸¡è‚‰éƒ½æ˜¯å¯é€‰çš„, ä¸‡ä¸€åƒç‰›è‚‰å‘¢ğŸ˜„

//  ??
let x = null;
let y = x ?? "default"; // y = "default"
```

## TSä¸­ç±»å‹å±‚çº§æœ‰å“ªå‡ å±‚?

> ç±»å‹é€šå¸¸åªèƒ½`æ”¶çª„` , é™¤äº† `interface` å’Œ `type` å¯ä»¥æ‹“å±• , `type` ä¸€æ—¦å®šä¹‰åˆ™æ— æ³•æ”¹å˜

- any
- unknown
- Object,object,{}
- String,Boolean,Number
- string,boolean,number
- ...è¡¥å……å›¾ç‰‡, `é›†åˆå›¾` or `å±‚çº§å›¾`

`string,boolean,number` åˆè¢«ç§°ä¸º`åŒ…è£…ç±»å‹`, JS ä¼š`è‡ªåŠ¨è£…ç®±/æ‹†ç®±`

## ç±»å‹çº¦æŸæœ‰å“ªäº›æ–¹æ³•?

> `TypeScript` æ‹¥æœ‰å›¾çµå®Œå¤‡çš„ç±»å‹ç³»ç»Ÿ
 
- if/else
- typeof
- keyof
- in
- is
- extends
- interface/type
- ...etc 
## interface å’Œ ç±»å‹åˆ«å çš„åŒºåˆ«?

> æœ‰ä¸¤ç§æ–¹æ³•å»å®šä¹‰ä¸€ä¸ªå¯¹è±¡çš„å½¢çŠ¶: æ¥å£ interface å’Œ ç±»å‹åˆ«å type aliases

å®ƒä»¬éå¸¸ç›¸ä¼¼, å¹¶ä¸”åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ç›¸åŒçš„, ä½†è¿˜æ˜¯æœ‰ä¸€äº›ç»†å¾®çš„åŒºåˆ«

- `interface` å¯ä»¥**åŒåå¹¶ä¸”è‡ªåŠ¨åˆå¹¶**, è€Œ `type` ä¸è¡Œ, ä¸”å®šä¹‰å**æ— æ³•æ”¹å˜**, éœ€è¦é€šè¿‡ `&` æ‹“å±•ä¸€ä¸ªæ–°çš„ `type`
- `interface` ä¸å¯ä»¥å®šä¹‰**åŸºæœ¬ç±»å‹**, è€Œ `type` å¯ä»¥
- `interface` æ›´é€‚åˆ**ç¬¬ä¸‰æ–¹åº“**ä½¿ç”¨, è€Œ `type` é€‚åˆåœ¨**å†…éƒ¨é¡¹ç›®**


## unknown å’Œ any çš„åŒºåˆ«?

- `any` ç›¸å½“äºä¸‡èƒ½ç±»å‹, **è·³è¿‡ç±»å‹æ£€æŸ¥**, å’Œå†™æ™®é€šçš„ `JavaScript` ä¸€æ ·

- `unknown` è¡¨ç¤ºä½ç½®ç±»å‹, æ¯”å¦‚ä¸€ä¸ª `axios è¯·æ±‚çš„è¿”å›ç»“æœ` , ä½ å¹¶ä¸çŸ¥é“è¿”å›çš„æ•°æ®å½¢çŠ¶æ˜¯ä»€ä¹ˆ, åˆ™å¯ä»¥å®šä¹‰ä¸º `unknown`, éšåå† é€šè¿‡ `as` æˆ– `infer`  **æ–­è¨€æˆ–è€…æ¨æ–­** ä¸ºå…·ä½“ç±»å‹ä¿è¯ç±»å‹å®‰å…¨

## exclude å’Œ Omit çš„åŒºåˆ«?

> `Exclude` ç”¨äº**ä»è”åˆç±»å‹ä¸­æ’é™¤æŸäº›ç±»å‹**ï¼Œè€Œ `Omit` ç”¨äº**ä»å¯¹è±¡ç±»å‹æˆ–æ¥å£ä¸­æ’é™¤æŸäº›å±æ€§**

```ts {1,6}
// Exclude æ’é™¤ union type ä¸­æŸä¸ªç±»å‹
type T = 'a' | 'b' 

type U = Exclude<T, 'a'> // type U = 'b'

// Omit æ’é™¤ type / interface å…¶ä¸­çš„æŸä¸ªå±æ€§
type T = { 
  a: string,
  b: string, 
}

type U = Omit<T, 'a'> // type U = { b: string; }
```

## infer å¦‚ä½•ä½¿ç”¨?

> `infer`ç”¨äºåœ¨æ¡ä»¶ç±»å‹ä¸­å£°æ˜ä¸€ä¸ª**å¾…æ¨æ–­çš„ç±»å‹å˜é‡**, å¿…é¡»å‰ç½®æ­é… `extends` ä½¿ç”¨

å¯ä»¥ä½¿ç”¨inferæ¥æ¨æ–­å‡½æ•°å‚æ•°çš„ç±»å‹
```ts {2,5}
type ParamType<T> = T extends (arg: infer P) => any ? P : T
```
`infer P` è¡¨ç¤ºå¾…æ¨æ–­çš„å‡½æ•°å‚æ•°ã€‚æ•´å¥è¡¨ç¤ºä¸ºï¼šå¦‚æœ `T` èƒ½èµ‹å€¼ç»™`(arg: infer P) => any`ï¼Œåˆ™ç»“æœæ˜¯ `(arg: infer P) => any`ç±»å‹ä¸­çš„ `å‚æ•°P`ï¼Œå¦åˆ™è¿”å›ä¸º `T`

---

> é™¤äº†æ¨æ–­**å‡½æ•°å‚æ•°çš„ç±»å‹**ï¼Œ`infer`è¿˜å¯ä»¥ç”¨äº**æ¨æ–­å‡½æ•°è¿”å›å€¼çš„ç±»å‹**

```ts
type ReturnType<T> = T extends (...args: any[]) => infer R ? R : any
```
åœ¨è¿™ä¸ªæ¡ä»¶è¯­å¥ `T extends (...args: any[]) => infer R ? R : any` ä¸­ï¼Œ`infer R`è¡¨ç¤ºå¾…æ¨æ–­çš„å‡½æ•°è¿”å›å€¼ã€‚æ•´å¥è¡¨ç¤ºä¸ºï¼šå¦‚æœ `T` èƒ½èµ‹å€¼ç»™`(...args: any[]) => infer R`ï¼Œåˆ™ç»“æœæ˜¯ `(...args: any[]) => infer R`ç±»å‹ä¸­çš„`è¿”å›å€¼R`ï¼Œå¦åˆ™è¿”å›ä¸º`any`

## æ€ä¹ˆç†è§£è£…é¥°å™¨?
> è£…é¥°å™¨æœ¬èº«æ˜¯ä¸€ä¸ª**å‡½æ•°**ï¼Œå®ƒå¯ä»¥**æ¥æ”¶è¢«è£…é¥°çš„ç›®æ ‡ä½œä¸ºå‚æ•°**ï¼Œå¹¶è¿”å›**è£…é¥°åçš„ç»“æœ**

åœ¨ `nest.js` ä¸­, å¯ä»¥é€šè¿‡`@Get` å®šä¹‰ä¸€ä¸ª `Get è¯·æ±‚`, è¿™å®é™…ä¸Šä½¿ç”¨ `typescript` çš„**è£…é¥°å™¨** (decortor)

æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆçœ¼ç†Ÿ, `@è£…é¥°å™¨` çœ‹èµ·æ¥å¾ˆç±»ä¼¼ java ä¸­çš„ **æ³¨è§£**, ä½†å…¶å®æ˜¯ä¸¤ä¸ªä¸åŒçš„ä¸œè¥¿
```ts
import { Controller, Get } from '@nestjs/common';

@Controller('my-route')
export class MyController {
  @Get()
  myMethod() {
    // å¤„ç†GETè¯·æ±‚
  }
}
```

>ç®€åŒ–ç‰ˆçš„@Get()è£…é¥°å™¨å®ç°ç¤ºä¾‹, å®é™…ä¸Š`nestjs` å®ç°æ›´åŠ å¤æ‚

å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š**ç›®æ ‡å¯¹è±¡**ã€**å±æ€§å**å’Œ**å±æ€§æè¿°ç¬¦**ã€‚åœ¨`@Get()`è£…é¥°å™¨å‡½æ•°å†…éƒ¨ï¼Œå®ƒä¼šä½¿ç”¨TypeScriptæä¾›çš„`Reflect API`æ¥è·å–å’Œè®¾ç½®**è¢«è£…é¥°æ–¹æ³•çš„å…ƒæ•°æ®ä¿¡æ¯**
```ts
function Get(path?: string): MethodDecorator {
  return (target, propertyKey, descriptor) => {
    // è·å–åŸå§‹æ–¹æ³•
    const originalMethod = descriptor.value;
    // è®¾ç½®å…ƒæ•°æ®ä¿¡æ¯
    Reflect.defineMetadata('path', path, descriptor.value);
    Reflect.defineMetadata('method', 'GET', descriptor.value);
    // è¿”å›å±æ€§æè¿°ç¬¦
    return descriptor;
  };
}
```
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸ºGetçš„å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå¯é€‰çš„è·¯å¾„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–¹æ³•è£…é¥°å™¨å‡½æ•°ã€‚åœ¨æ–¹æ³•è£…é¥°å™¨å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨`Reflect.defineMetadata`æ–¹æ³•æ¥è®¾ç½®è¢«è£…é¥°æ–¹æ³•çš„å…ƒæ•°æ®ä¿¡æ¯

## æ€ä¹ˆç†è§£ç±»å‹å…¼å®¹?

> åœ¨[å®˜ç½‘](https://www.typescriptlang.org/docs/handbook/type-compatibility.html#any-unknown-object-void-undefined-null-and-never-assignability)çš„è§£é‡Šä¸­ï¼Œ`Typescript`Â å­˜åœ¨ä¸¤ç§ã€Œç±»å‹å…¼å®¹ã€æ–¹å¼ï¼š`Subtype`ã€`Assignment`

:::tip **é›†åˆè®ºä¸­ï¼Œå¦‚æœä¸€ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ åœ¨é›†åˆBä¸­éƒ½å­˜åœ¨ï¼Œåˆ™Aæ˜¯Bçš„å­é›†**
`ts ä¸­çš„ç±»å‹ç³»ç»Ÿ`å®é™…ä¸Šæ˜¯**ä¸åŒç±»å‹**ä¹‹é—´çš„`é›†åˆè¿ç®—` , å¦‚äº¤é›†ã€å¹¶é›†ã€åŒ…å«äºã€è¢«åŒ…å«äº...

:::


### Subtype

:::tip å­ç±»å‹(Subtype) 
ç±»å‹ç³»ç»Ÿä¸­ï¼Œå¦‚æœ**ä¸€ä¸ªç±»å‹çš„å±æ€§æ›´å…·ä½“**ï¼Œåˆ™è¯¥ç±»å‹æ˜¯**å­ç±»å‹**ï¼ˆå› ä¸ºå±æ€§æ›´å°‘åˆ™è¯´æ˜è¯¥ç±»å‹çº¦æŸçš„æ›´å®½æ³›ï¼Œæ˜¯çˆ¶ç±»å‹ï¼‰
- å­ç±»å‹æ›´å…·ä½“ï¼Œçˆ¶ç±»å‹æ›´å®½æ³›
- å­ç±»å‹å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»å‹
- å¯ä»¥é€šè¿‡ `extends` æ¥åˆ¤æ–­æ˜¯å¦æ˜¯è¯¥ç±»å‹çš„å­ç±»å‹
:::

```ts {13,14}
type A = {
  name:string,
  age:number
}

type B = {
  name: string,
}

let a: A = {name:'keqing',age:20}
let b: B = {name:'ganyu'};

b = a; // OK
a = b // Error Property 'age' is missing in type 'B' but required in type 'A'

function fn( name: A extends B ? string : number ) {
  console.log(typeof name) // typeof name è¿”å›çš„ç±»å‹æ˜¯ string, A æ˜¯ B çš„å­ç±»å‹
}
```
### Assignment

## æ€ä¹ˆç†è§£ åå˜/é€†å˜ ?

> è¿™éƒ¨åˆ†å¤ªéš¾å¤ªçƒ§è„‘äº† , åç»­ç†è§£å†è¡¥å……
### åå˜

### é€†å˜

### åŒå‘åå˜
